<app-chat-slider
  [(visible)]="_sidebarVisible"
  [modal]="false"
  (onHide)="_sidebarVisible = false"
  [position]="'right'"
  [styleClass]="'onecx-chat-sidebar p-0'"
>
  <div class="onecx-companion-container" *ngrxLet="viewModel$; let vm">
    <ng-container *ngIf="!selectedChatMode">
      <app-chat-initial-screen (selectMode)="selectChatMode($event)"></app-chat-initial-screen>
    </ng-container>
    <ng-container *ngIf="selectedChatMode">
      <div class="chat-interface" [@slideIn]>
        <app-chat-header
          [title]="vm.chatTitleKey | translate"
          [showBack]="true"
          [showClose]="false"
          (backClicked)="goBack()"
        ></app-chat-header>
        <app-chat-list
          *ngIf="selectedChatMode === 'ai'"
          [chats]="vm.chats"
          [loading]="vm.chats === undefined"
          [selectedChat]="vm.currentChat"
          (chatSelected)="chatSelected($event)"
          [menuItems]="(menuItems | async) ?? []"
        ></app-chat-list>
        <app-chat
          [chatMessages]="vm.currentMessages ?? []"
          (sendMessage)="sendMessage($event)"
          (retrySendMessage)="sendMessage($event)"
        ></app-chat>
      </div>
    </ng-container>
  </div>
</app-chat-slider>
<div class="layout-topbar-item">
  <p-button
    styleClass="chat-button p-button-rounded p-button-text"
    [attr.aria-label]="'CHAT.TITLE_AI' | translate"
    [pTooltip]="'CHAT.TITLE_AI' | translate"
    tooltipPosition="top"
    tooltipEvent="hover"
    (onClick)="_sidebarVisible = true"
  >
    <i class="pi pi-comments fs-xlarge p-button-icon" style="background: transparent; border: none;"></i>
  </p-button>
</div>
